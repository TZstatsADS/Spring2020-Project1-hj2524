install.packages("wordcloud")
knitr::opts_chunk$set(echo = TRUE)
install.packages("textdata")
library(tm)
library(data.table)
library(tidytext)
library(tidyverse)
library(DT)
library(wordcloud)
library(RColorBrewer)
# load lyrics data
load('../output/processed_lyrics.RData')
artists <- read_csv("~/GitHub/Spring2020-Project1-hj2524/data/artists.csv")
team_list<-artists%>%select(-Intro,-Origin)%>%filter(!is.na(Formed)|!is.na(Members))%>%filter(is.na(Formed)|!Formed==199)%>%pull(Artist)
data<-dt_lyrics%>%mutate(team=artist%in%team_list)%>%filter(year>1000)%>%
mutate(  year=fct_recode(cut(year-1900,breaks=seq(60,120,10)),
"60s" = "(60,70]",
"70s" = "(70,80]",
"80s" = "(80,90]",
"90s" = "(90,100]",
"00s" = "(100,110]",
"10s" = "(110,120]")    )
tdm<-function(data){
corpus<-VCorpus(VectorSource(data$stemmedwords))
tdm.all<-TermDocumentMatrix(tm_map(corpus, stemDocument))
tdm.tidy=tidy(tdm.all)
tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
return(tdm.overall)
}
wordcloudplot<-function(data){
tdm.overall_nolove<-data#%>%filter(term!="love")
wordcloud(tdm.overall_nolove$term, tdm.overall_nolove$`sum(count)`,
scale=c(5,0.5),
max.words=200,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
}
data_Pop<-data%>%filter(genre%in% c("Pop"))
tdm_Pop=tdm(data_Pop)
wordcloudplot(tdm_Pop)
data_team_P<-data_Pop%>%filter(team)
data_indiv_P<-data_Pop%>%filter(!team)
wordcloudplot(data_team_P)
tdm_Pop
tdm_Pop%>%arrange(desc(`sum(ccount()`))
tdm_Pop%>%arrange(desc(`sum(ccount`))
tdm_Pop%>%arrange(desc(`sum(count`))
tdm_Pop%>%arrange(desc(`sum(count)`))
wordcloud(tdm.overall_nolove$term, tdm.overall_nolove$`sum(count)`,
scale=c(5,0.5),
max.words=200,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Black"))
wordcloud(tdm.overall_nolove$term, tdm.overall_nolove$`sum(count)`,
scale=c(5,0.5),
max.words=200,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE)
wordcloudplot<-function(data){
tdm.overall_nolove<-data#%>%filter(term!="love")
wordcloud(tdm.overall_nolove$term, tdm.overall_nolove$`sum(count)`,
scale=c(5,0.5),
max.words=200,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE)
}
wordcloudplot(tdm_Pop)
data_team_P<-data_Pop%>%filter(team)
data_indiv_P<-data_Pop%>%filter(!team)
wordcloudplot(data_team_P)
data_team_P<-data_Pop%>%filter(team)
data_indiv_P<-data_Pop%>%filter(!team)
wordcloudplot(tdm(data_team_P))
wordcloudplot(tdm(data_indiv_P))
